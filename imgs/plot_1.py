import matplotlib.pyplot as plt
import pandas as pd
import numpy as np
import warnings
from numpy import *
from matplotlib.cm import get_cmap
colors = [i for i in get_cmap('tab20').colors]
colors_b = [i for i in get_cmap('tab20b').colors]
colors_c = [i for i in get_cmap('tab20c').colors]
from matplotlib.legend_handler import HandlerLine2D, HandlerTuple


GSE = [-4.75877048 for _ in range(31)]
beta = [0.03 * _ for _ in range(31)]
Exp = [-4.000599760055995, -4.159872494281471, -4.285006100396268, -4.382726012115482, -4.459050048204498, -4.51878060173215, -4.565678761657578, -4.602655658738666, -4.631949291914776, -4.655274645218798, -4.673945107871795, -4.688967824939866, -4.701117205819326, -4.710990949179411, -4.719052455527538, -4.725662823165561, -4.731104958440149, -4.7356017545985285, -4.739329824570837, -4.7424299053681755, -4.745014770077713, -4.747175270649433, -4.748984975398299, -4.750503746597518, -4.751780515580545, -4.752855447601484, -4.75376164042692, -4.754526464838113, -4.755172628639395, -4.75571902598095, -4.756181419032841]
D2 = [-4.000599820019784, -4.164344844238052, -4.299613212040344, -4.4091891529497165, -4.496376413329985, -4.564288126895796, -4.615780746351825, -4.653421223666497, -4.679478110718275, -4.695929011605584, -4.704478466293616, -4.706581797517588, -4.703471672722717, -4.6961851259776015, -4.685589557917963, -4.67240681826929, -4.657234901209431, -4.6405670811968465, -4.622808514262426, -4.604290452301043, -4.585282286500929, -4.566001659743184, -4.546622954056, -4.527284241624539, -4.508091799358397, -4.489131847408879, -4.470460701215064, -4.452122021945567, -4.434142726410753, -4.416536815573717, -4.3993074956513905]
D_rdm = [-4.000599800030522, -4.162820697703546, -4.294504255998415, -4.3996593465344285, -4.482496883525898, -4.546766440009547, -4.595743081719348, -4.632244567754501, -4.658666079113659, -4.6770233717262695, -4.6889986851025185, -4.695985772085795, -4.699131907405851, -4.699375748995744, -4.6974806097704, -4.694063139834079, -4.689617686659485, -4.684536744065959, -4.6791280657228, -4.673628166462739, -4.668214901404981, -4.663015783216946, -4.658116143146536, -4.653565217878528, -4.649381195782997, -4.64555550885018, -4.642056285362917, -4.638831761075728, -4.635813275913728, -4.632918295486086, -4.630053545620915]
Drl = [-4.000599800029128, -4.164355007349154, -4.299688716570891, -4.409425309696159, -4.496894251604528, -4.565222423170858, -4.617270688885418, -4.6556037295660655, -4.682483631553113, -4.699879493876517, -4.709487067525162, -4.712753842272027, -4.7185506007754805, -4.722767528329081, -4.725112284744253, -4.726134127176117, -4.726257091194018, -4.7258026145833, -4.725008249897954, -4.724551762348567, -4.725220373465239, -4.726064054213647, -4.727106995326144, -4.728343189362429, -4.729741244144889, -4.731249519595273, -4.732810180448983, -4.734334288830031, -4.735737542860394, -4.73692569934835, -4.737800936583398]

P2 = [0.8135693103144431, 0.8479148176801681, 0.8774327140758897, 0.9023332584699093, 0.9230104383767767, 0.9398876261918409, 0.9533938865750693, 0.9639467478042832, 0.9719404634922282, 0.9777387323526636, 0.9816708820550296, 0.9840306241117266, 0.985076619282646, 0.9850342379190176, 0.984098037103853, 0.9824346000888398, 0.9801854868278381, 0.9774701271217778, 0.9743885512212239, 0.971023899304637, 0.9674446841312832, 0.9637068014390626, 0.9598553120984982, 0.9559259750475184, 0.9519462769190344, 0.9479383250111457, 0.9439164425577063, 0.9398915181880789, 0.9358700893699327, 0.9318554026168402, 0.9278480559927617]
P_rdm = [0.8135693059754374, 0.8475732966044334, 0.8762499800825277, 0.9000508506343159, 0.9195636207233776, 0.9353595686012693, 0.9479748775015159, 0.9578997541822754, 0.9655733103527404, 0.9713824503278747, 0.9756634640840137, 0.9787053048258912, 0.9807537925163627, 0.9820162002558003, 0.9826658542954949, 0.9828465134067979, 0.9826763934168562, 0.9822517732571608, 0.9816501901718072, 0.9809330656931793, 0.9801483042877005, 0.9793320492276372, 0.9785104936351557, 0.9777012808710399, 0.976914708930227, 0.9761547931543243, 0.9754201417488131, 0.9747048378951957, 0.973999209699418, 0.973290599974013, 0.9725641272583944]
Prl = [0.8135693060844131, 0.8479340482219981, 0.8775093083585511, 0.9025036959689554, 0.9233083631732422, 0.9403430226862581, 0.9540325398106864, 0.9647899387328319, 0.9730048551516337, 0.9790363945898191, 0.9832094096765017, 0.9858132810529716, 0.9871024655682109, 0.9884746071608683, 0.9900693304686593, 0.9912087199312423, 0.9919942657230252, 0.9925057439888936, 0.99280476788174, 0.9929378527959033, 0.9929390433773356, 0.9930501313494476, 0.9934770014745488, 0.9938826857661064, 0.9942674679372787, 0.9946257595020165, 0.9949535054842359, 0.9952342166155753, 0.9954553967502706, 0.9956010943165124, 0.9956541690837148]
P2 = [np.sqrt(_) for _ in P2]
P_rdm = [np.sqrt(_) for _ in P_rdm]
Prl = [np.sqrt(_) for _ in Prl]


exbeta = [0, 0.12,0.33,0.54,0.72,0.90]
exD2 = [-3.970381255741741, -4.39382863138257, -4.626144476133029, -4.56436348775287, -4.4466758759145675, -4.3678370221556175]
exD_rdm = [-3.970381255741741, -4.354857613605517, -4.612370241320312, -4.641648922148243, -4.629843607261462, -4.598140253286748]
exDrl = [-3.970381255741741, -4.416052031093688, -4.6514792736754025, -4.679605998623811, -4.677908717660331, -4.693160233654691]
exGSE = [-4.758770483 for _ in range(6)]

exP2 = [0.802991593418, 0.8945540560688283, 0.9619429631366864, 0.9529847610122988,  0.9363226729942911, 0.9187573883044803]
exP_rdm = [0.802991593418, 0.8847520837463266, 0.9478040212893903, 0.9614374021352035, 0.9647891669238504, 0.9620147104335786]
exPrl = [0.802991593418, 0.9009781688958362, 0.9643649003489224, 0.9739732522977748, 0.9742704697840613, 0.9806438969362049]
exP2 = [np.sqrt(_) for _ in exP2]
exP_rdm = [np.sqrt(_) for _ in exP_rdm]
exPrl = [np.sqrt(_) for _ in exPrl]




plt.figure(figsize=(6.4, 16.4))
plt.subplot(3,1,1)
p00, = plt.plot(beta, D2, "d", color = colors[0], markersize = 6, linewidth=1.5)
p01, = plt.plot(exbeta, exD2, "d", color = colors[0], markerfacecolor='none', markersize = 6, linewidth=1.5)
p10, = plt.plot(beta, D_rdm, "d", color = colors[4], markersize = 6, linewidth=1.5)
p11, = plt.plot(exbeta, exD_rdm, "d", color = colors[4], markerfacecolor='none', markersize = 6, linewidth=1.5)
p20, = plt.plot(beta, Drl, "d", color = colors[6], markersize = 6, linewidth=1.5)
p21, = plt.plot(exbeta, exDrl, "d", color = colors[6], markerfacecolor='none', markersize = 6, linewidth=1.5)
p3 = plt.plot(beta, GSE, "-.", color = "black", markersize = 4, linewidth=1.5)
# p4 = plt.plot(beta, Exp, "-", color = "black", markersize = 4, linewidth=1.5)


plt.legend([(p00, p01), (p10, p11),(p20, p21)], ['QITE','Randomized QITE','RL-steered QITE'], numpoints=1,
               handler_map={tuple: HandlerTuple(ndivide=None)}, frameon=True, loc = 'best', fontsize = "x-large")

plt.title(r"(a)", loc="left", fontsize=18)
plt.xlabel(r"$\beta$", fontsize = "xx-large", fontname = "Times New Roman")
plt.ylabel(r"$E$", fontsize = "xx-large", fontname = "Times New Roman")
plt.xticks(fontsize=12)
plt.yticks(fontsize=12)
plt.ylim(-4.8 , -3.8)
plt.xlim(-0.04, 0.94)

plt.subplot(3,1,2)
p00, = plt.plot(beta, P2, "d", color = colors[0], markersize = 6, linewidth=1.5)
p01, = plt.plot(exbeta, exP2, "d", color = colors[0], markerfacecolor='none', markersize = 6, linewidth=1.5)
p10, = plt.plot(beta, P_rdm, "d", color = colors[4], markersize = 6, linewidth=1.5)
p11, = plt.plot(exbeta, exP_rdm, "d", color = colors[4], markerfacecolor='none', markersize = 6, linewidth=1.5)
p20, = plt.plot(beta, Prl, "d", color = colors[6], markersize = 6, linewidth=1.5)
p21, = plt.plot(exbeta, exPrl, "d", color = colors[6], markerfacecolor='none', markersize = 6, linewidth=1.5)
# p3 = plt.plot(beta, GSE, "-.", color = "black", markersize = 4, linewidth=1.5)
plt.legend([(p00, p01), (p10, p11),(p20, p21)], ['QITE','Randomized QITE','RL-steered QITE'], numpoints=1,
               handler_map={tuple: HandlerTuple(ndivide=None)}, frameon=True, loc = 'best', fontsize = "x-large")


plt.title("(b)", loc='left', fontsize=18)
plt.xlabel(r"$\beta$", fontsize = "xx-large", fontname = "Times New Roman")
plt.ylabel(r"$F$", fontsize = "xx-large", fontname = "Times New Roman")

plt.xticks(fontsize=12)
plt.yticks(fontsize=12)
plt.ylim(0.89 , 1)
plt.xlim(-0.04, 0.94)

steps = [_ for _ in range(1, 29)]
E0 = [1.232595164407831e-32, 3.6977854932234923e-32, 2.619264724366641e-32, 2.619264724366641e-32, 0.006280127917874531, 0.012123579689031303, 0.017945947076781633, 0.012383115747925019, 0.008110578361919495, 0.012194116436671992, 0.0032491470782920664, 0.02205260319481693, 0.02981026263356207, 0.046892901149513735, 0.03044689727289824, 0.024808396199218957, 0.03258043844829466, 0.009407262537556658, 0.03692737553508369, 0.04407707103839839, 0.06857886096094847, 0.04351864169588619, 0.03901627114633105, 0.04796614762535149, 0.014382044986336266, 0.04719917319284362, 0.05290731935455169, 0.08175753673282665]
E1 = [1.232595164407831e-32, 3.6977854932234923e-32, 1.232595164407831e-32, 0.002312033615060892, 0.008158915052407997, 0.013993793077031346, 0.011992750457189883, 0.022446537511407943, 0.031060794470001336, 0.030956059393734116, 0.005332964010537828, 0.014615001036846285, 0.02404113503793341, 0.013721996414668283, 0.029906708294084716, 0.035486628416011516, 0.009974989128794751, 0.0085029879900119, 0.01675966703181073, 0.03351363521950338, 0.015119426196182556, 0.03615351405689214, 0.04131091574917743, 0.013209059705329002, 0.03170739719248292, 0.04007817460999912, 0.021514034401015947, 0.006669684086241812]
E2 = [1.232595164407831e-32, 3.6977854932234923e-32, 5.22810016886375e-05, 0.002364254179032863, 0.007434176465824855, 0.00973761604794117, 0.015412134082954342, 0.009310605842630942, 0.011851290542273088, 0.00584987941316371, 0.01780478829198731, 0.014530735464543648, 0.022193790713087174, 0.040713046806149476, 0.05427995602862032, 0.0766987145844018, 0.09830573647286045, 0.06251086192742025, 0.018464748559708616, 0.025273086226643524, 0.024706040575800156, 0.05054726334767019, 0.040599721120168165, 0.05981974857745714, 0.070221959863032, 0.04168042045495104, 0.02650502474164263, 0.030091054032895498]

# E0 = [2.220446049250313e-16, 4.440892098500626e-16, 0.0, 0.0, 0.0062702679162085495, 0.012086834392912249, 0.017865432822660843, 0.01234478070840439, 0.008094133431775119, 0.012156942754995237, 0.0032465082817604296, 0.021931024554709744, 0.029588100326742972, 0.04634316572666397, 0.030215144059307475, 0.02465453230103687, 0.03231506743266643, 0.009385138622831635, 0.03658646812305888, 0.0435913743287657, 0.06740309624683516, 0.04304517375212591, 0.03863570391573001, 0.047390959909352603, 0.014330334299948788, 0.046642232871562106, 0.052207523413248524, 0.08008646319329293]
#
# E2 = [2.220446049250313e-16, 4.440892098500626e-16, 5.2280318362574185e-05, 0.0023628567545769252, 0.007420356046344723, 0.009713907090308949, 0.015352751466265246, 0.009288934290045847, 0.011816178375709252, 0.005841324626163602, 0.017725536764314764, 0.014477947401321911, 0.022070650255339386, 0.040298659444653384, 0.053543378806868436, 0.07522804246366588, 0.09588973287768321, 0.061533960877219185, 0.018379512214067972, 0.02511340435118936, 0.02455344349386035, 0.0499085070814872, 0.040187636621262124, 0.05892514800810389, 0.0689891786230824, 0.041246105625431406, 0.026329395725872562, 0.029864686190451684]
#
# E1 = [2.220446049250313e-16, 4.440892098500626e-16, 0.0, 0.002310697240201054, 0.00814227307870008, 0.013944836515860648, 0.011956794185556952, 0.02232125771620852, 0.030817312758616433, 0.030713859149427702, 0.005327597284842556, 0.014563163296637982, 0.023898573628507558, 0.013677380873496903, 0.029679099063347314, 0.03516585034855302, 0.00994886728731359, 0.008483909265199041, 0.016688831016100747, 0.03323146722662795, 0.015061078645113524, 0.03582373737893818, 0.04088002179522776, 0.013163885192873925, 0.03145449090050856, 0.03967578941250438, 0.021397593829383554, 0.006658116902382161]



plt.subplot(3,1,3)
plt.plot(steps, E0, "-", color = colors[0], markersize = 3, linewidth=1.5, label="QITE")

plt.plot(steps, E2, "-", color = colors[4], markersize = 3, linewidth=1.5, label="Randomized QITE")

plt.plot(steps, E1, "-", color = colors[6], markersize = 3, linewidth=1.5, label="RL-steered QITE")



plt.plot([28], [0.08175753673282665], "d", color = colors[0], markersize = 4)
plt.plot([28], [0.030091054032895498], "d", color = colors[4], markersize = 4)
plt.plot([28], [0.006669684086241812], "d", color = colors[6], markersize = 4)

plt.xlabel(r"Evolution step", fontsize = "xx-large", fontname = "Times New Roman")
plt.ylabel(r"$\epsilon_{alg}$", fontsize = "xx-large", fontname = "Times New Roman")

plt.legend(loc = 'best', fontsize = "x-large")

plt.title("(c)", loc="left", fontsize=18)


plt.xticks(fontsize=12)
plt.yticks(fontsize=12)



plt.savefig("Fig3.pdf")
plt.close()
